# 作战环境下军事目标数据集生成与管理平台 - 需求规格说明书

## 1. 引言

### 1.1. 项目背景
为满足在多变作战环境下对军事目标识别与分析的需求，需要一个能够高效生成多样化、高质量模拟图像数据集的平台。该平台旨在通过结合传统图像合成技术与先进的AI生成模型，为军事AI模型的训练与验证提供丰富的、带标注的数据支持。

### 1.2. 项目目标
本项目的主要目标是开发一个集数据集生成、标注、管理于一体的综合性平台。平台需能够根据用户配置，在不同的天气和地形场景中，生成包含坦克、战机、舰艇等军事目标的模拟图像，并自动完成分类与检测标注，同时提供完整的数据集生命周期管理功能。

### 1.3. 范围
本项目覆盖从用户交互界面（GUI）、图像生成引擎、自动标注系统到数据集存储与管理的全部开发工作。具体包括：
- **前端GUI应用**：支持用户进行参数配置和任务管理。
- **图像生成模块**：支持传统合成与AI生成两种模式。
- **自动标注模块**：生成与图像匹配的分类和检测标注信息。
- **数据集管理模块**：对生成的数据集进行增、删、改、查等操作。
- **AI模型模块**：包含基准模型的部署应用和定制化模型的训练与集成。

### 1.4. 读者对象
本文档主要面向项目经理、开发工程师、测试工程师以及甲方项目相关负责人，用于明确项目需求、指导开发设计与后期验收。

---

## 2. 总体描述

### 2.1. 产品功能
平台核心功能是围绕军事目标图像数据集的生成与管理，具体功能点摘要如下：
- **多场景图像生成**：根据"天气+地形+军事目标"的组合，生成模拟图像。
- **可配置生成参数**：用户可自定义生成数量、目标类型、场景类型等。
- **自动化标注**：在生成图像的同时，自动创建分类和检测（Bounding Box）两种类型的标注。
- **标注预览**：支持在图像上临时预览近似的包围框（Bbox）。
- **数据集管理**：提供创建、查询、更新、删除数据集的功能。
- **自动分组**：生成的数据集自动按80%（训练集）、10%（验证集）、10%（测试集）的比例进行划分。
- **双模生成引擎**：支持**传统蒙版合成**与基于Stable Diffusion的**AI生成**两种图像生成模式。

### 2.2. 用户特征
本平台的用户主要是算法工程师、数据分析师或相关军事领域的AI研究人员。他们具备基本的计算机操作能力和对图像数据集的认知，需要通过本平台快速获取用于模型训练的模拟数据。

### 2.3. 主要约束与假设
- **硬件依赖**：AI模型的本地部署和训练强依赖于甲方提供的GPU硬件资源。
- **交付标准**：生成图像的质量以"视觉合理"作为交付标准，不追求与真实场景的完全一致性。
- **AI生成特性**：AI生成过程可能耗时较长、存在失败风险，且生成结果可能出现重复或抽象等不确定性，这些被视为AI模型固有特性，不视为产品缺陷（Bug）。
- **训练数据**：定制化模型的训练效果直接取决于甲方提供的训练样本数据的质量和数量。

---

## 3. 功能需求

### 3.1. 用户图形界面 (GUI)
- **3.1.1. 运行环境**：支持在 Windows 和 Linux 操作系统上运行。
- **3.1.2. 数据集生成配置**：
    - **生成数量**：用户可输入期望生成的图片总数，单次任务上限为10,000张。
    - **目标选择**：支持选择单一军事目标（坦克/战机/舰艇）或选择"混合随机"模式，由系统随机组合目标。
    - **场景天气选择**：支持选择单一天气/地形场景，或选择"混合随机"模式，由系统随机组合场景。
- **3.1.3. 任务启动**：提供清晰的"开始生成"按钮，允许用户根据当前配置启动数据集生成任务。

### 3.2. 图像数据集生成
- **3.2.1. 图像源**：
    - **军事目标**：由甲方提供坦克、战机、舰艇三类的图像样本集。
    - **背景场景**：由乙方提供雨天、雪天、大雾、夜间四种天气和城市、岛屿、乡村三种地形的背景素材。
- **3.2.2. 生成组合**：系统需支持将上述天气、场景和目标进行任意组合，生成合成图像。
- **3.2.3. 图像质量**：
    - 生成的图像需保证清晰、自然、合理。
    - 不对分辨率做强制要求，不支持超高清（如2K, 4K）图像的生成。
- **3.2.4. 生成模式**：平台需支持以下两种生成方式，用户可在创建任务时选择其一。
    - **传统模式（蒙版合成）**：利用图像蒙版（Mask）技术，将甲方提供的、已抠图的军事目标图像样本，精准地叠加到乙方提供的背景场景图像上。通过后期处理调整光照、风格等，以实现快速、可控的图像合成。
    - **AI生成模式**：基于AI模型（如Stable Diffusion）进行图像生成，无需预先提供目标图像样本，通过文本描述（Prompt）来控制生成内容。详细需求见 3.6 节。

### 3.3. 图像标注
- **3.3.1. 自动标注**：图像生成过程中，同步生成对应的标注信息。
- **3.3.2. 标注类型**：
    - **分类标注**：为每张图片标注其包含的主要军事目标类别（坦克、战机、舰艇）。
    - **检测标注**：为图片中的每个军事目标生成一个近似的边界框（Bounding Box），记录其位置坐标。标注格式遵循COCO标准。
- **3.3.3. 标注预览**：在GUI中，支持用户查看某张图片时，能够在该图上临时叠加一个半透明的Bbox以预览检测标注效果。此预览不应修改或污染原始图片文件。

### 3.4. 数据集存储
- **3.4.1. 存储结构**：每个生成的数据集应包含图像文件和标注文件。
- **3.4.2. 标注格式**：标注信息以`train.json`（以及`val.json`, `test.json`）的形式存储，遵循 COCO 数据集格式规范。
- **3.4.3. 自动分组**：系统在生成完毕后，自动将所有图片及对应标注按80%（训练）、10%（验证）、10%（测试）的比例划分，并分别存放在不同的目录或文件中。

### 3.5. 数据集管理 (CRUD)
- **3.5.1. Add (创建)**：支持用户创建一个新的数据集项目，可定义初始名称和描述。
- **3.5.2. Query (查询)**：
    - **列表展示**：在GUI中以列表形式展示所有已创建的数据集。
    - **统计信息**：展示每个数据集的概要信息，包括：总图片数量、包含的军事目标类别、采用的场景/天气类型等。
- **3.5.3. Update (更新)**：支持用户对已存在的数据集进行重命名或修改其描述信息。
- **3.5.4. Delete (删除)**：支持用户删除整个选定的数据集（包括所有图片和标注文件）。

### 3.6. AI模型集成
- **3.6.1. 基准扩散模型（Stable Diffusion）**
    - **模型版本**：使用开源的 Stable Diffusion 1.5 或 2.1 版本。
    - **部署方式**：支持在甲方提供的硬件上进行本地化部署。
    - **控制方式**：通过 `prompt` engineering 和 `Pipeline` 控制实现批量、可控的图像生成。
    - **异常处理**：
        - AI生成过程可能比传统方式更耗时。
        - 针对生成失败的情况，提供自动或手动的重试机制。
- **3.6.2. 定制化训练模型**
    - **技术方案**：基于 Stable Diffusion 模型进行微调（Fine-tuning）。
    - **训练数据**：由甲方提供，建议每类目标提供100-200张以上优质图像。
    - **交付物**：
        - 训练完成的本地模型权重文件。
        - 完整的模型推理（Inference）代码。
        - 详细的模型使用说明文档。
    - **集成**：训练出的新模型需要能嵌入到平台的工作流中，作为AI生成模式的一个可选选项。

---

## 4. 非功能需求

### 4.1. 性能需求
- **批量处理能力**：单次生成任务支持的最大图像数量为10,000张。
- **响应时间**：GUI操作应流畅响应。AI生成耗时依赖于硬件性能和生成数量，不作硬性规定，但应提供任务进度提示。

### 4.2. 可用性需求
- **易用性**：GUI界面应直观、简洁，主要功能通过点击式操作即可完成。
- **反馈机制**：对于耗时操作（如数据集生成），应提供明确的进度反馈。对于操作结果（成功/失败），应给予清晰的提示信息。

### 4.3. 硬件依赖
- AI模型的推理和训练必须在配备有合适GPU的服务器或工作站上进行，相关硬件由甲方提供。

### 4.4. 交付标准
- **软件**：可运行的平台应用程序（Windows/Linux）。
- **代码与模型**：
    - 平台完整源代码。
    - 对于定制化训练，交付本地模型权重、推理代码及使用文档。
- **文档**：
    - 用户手册。
    - 部署说明。
- **验收标准**：生成图像符合"视觉合理"标准，平台功能满足本文档所描述的需求。
### 4.5. 可移植性 (Portability)
- **核心要求**：项目所有组件，包括前端GUI、后端服务及命令行脚本，都必须无需使用容器化技术（如Docker），即可直接在标准的Windows和Linux发行版上部署和运行。
- **依赖管理**：需为不同组件（前端、后端）提供独立的 `requirements.txt` 文件，确保在两个平台上都能干净、一致地安装所需依赖。 